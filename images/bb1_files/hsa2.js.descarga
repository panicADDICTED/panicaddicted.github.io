(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1013:function(e,t,o){e.exports=o(1017)},1017:function(e,t,o){"use strict";o.r(t);var r=o(4),n=o.n(r),i=(o(16),o(50),o(88),o(527),o(122),o(3)),a=o.n(i),s=o(29),c=o(10),l=(o(13),o(81),o(0)),d=function(){};(d.prototype=new c.a).constructor=d,d.prototype.verifyPhone=function(e,t,o){var r={};return r.url=l.a.urlContext+"/auth/verify/phone/securitycode"+l.a.referrerQuery,r.data=JSON.stringify({phoneNumber:{id:e},securityCode:{code:t},mode:o}),r.headers={Accept:"application/json"},this.post(r)},d.prototype.verifyDevice=function(e){var t={};return t.data=JSON.stringify({securityCode:{code:e}}),t.url=l.a.urlContext+"/auth/verify/trusteddevice/securitycode"+l.a.referrerQuery,t.headers={Accept:"application/json"},this.post(t)},d.prototype.sendNewCode=function(e,t){var o={url:l.a.urlContext+"/auth/verify/phone",data:JSON.stringify({phoneNumber:{id:e},mode:t}),headers:{Accept:"application/json"}};return this.put(o)};var u=new d,h=o(31),p=o(2),f=o(18),g=o(110),v=o(191);function w(e,t,o,r,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function m(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post",r=document.createElement("form");for(var n in r.method=o,r.action=e,r.target="_blank",t)if(t.hasOwnProperty(n)){var i=document.createElement("input");i.type="hidden",i.name=n,i.value=t[n],r.appendChild(i)}document.body.appendChild(r),r.submit(),document.body.removeChild(r)}var y=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,o,r){var n,i,a,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.getRedirectUrl("/auth/account/recovery");case 3:n=e.sent,i=Object(s.a)(n,"jqXHR",{}),"string"==typeof(a=i.getResponseHeader("Location"))&&""!==a.trim()&&(c={redirectURL:a,returnUrl:Object(s.a)(l.a,"envConfigFromConsumer.returnUrl","#"),refererUrl:Object(s.a)(l.a,"refererUrl","#"),destinationDomain:Object(s.a)(l.a,"envConfigFromConsumer.returnUrl","#")},Object(s.a)(l.a,"envConfigFromConsumer.requestorContext",void 0)&&(c.requestorContext=l.a.envConfigFromConsumer.requestorContext),d=Object(g.a)(c),200===i.status?(m(d,i.responseJSON),t.preventDefault()):(o.attr("dialog.moreVerificationOptions.links.recovery",d),t.target.href=d)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),r(Object(s.a)(e.t0,"jqXHR",{}),o),t.preventDefault();case 13:case"end":return e.stop()}}),e,null,[[0,9]])})),function(){var t=this,o=arguments;return new Promise((function(r,n){var i=e.apply(t,o);function a(e){w(i,r,n,a,s,"next",e)}function s(e){w(i,r,n,a,s,"throw",e)}a(void 0)}))});return function(e,o,r){return t.apply(this,arguments)}}(),M=o(574),b=o.n(M),S=o(22);function C(e,t,o,r,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}var P=function(e,t){var o=null;return 1===t.length?o=t[0]:n.a.each(t,(function(t,r){t.id==e&&(o=t)})),o},O=function(e,t){n.a.each(e.phones,(function(o,r){o.id!==e.selectedPhone.id&&o.attr("disable",t)}))},T=function(e,t){var o=a()("phones"),r=Object(f.a)(e.responseJSON,p.a.getString("fallback"));switch(e.status){case 400:t.attr("errorMessage",r.message);break;case 409:o.trigger("next_409",[e]);break;case 423:r.status.isTooManyCodesSent&&t.attr("lastCodeSentTo.errorMessage",p.a.getString("tooManyCodesSent")),(r.status.isTooManyCodesValidated||r.status.isSecurityCodeLocked)&&t.attr("lastCodeSentTo.errorMessage",p.a.getString("securityCodeLocked")),o.trigger("phoneSelected",[e,t.attr("lastCodeSentTo")]);break;default:t.attr("errorMessage",r.message)}},k=(n.a.Component.extend({tag:"phones",template:n.a.view(b.a),viewModel:{define:{appleIdLinkTarget:{type:"string",value:function(){return l.a.appleIdLinkTarget}},recoveryNotAvailableLink:{type:"boolean",get:function(){return!(!this.attr("twoFactorVerificationSupportUrl")||this.attr("recoveryAvailable"))}}},mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),twoFactorVerificationSupportUrl:"",recoveryAvailable:!0,phones:{},lastCodeSentTo:null,isSendCodeLocked:!1,errorMessage:"",verifyMode:"",suppressIforgot:null,selectedPhone:null,showHelpDialog:!1,dialog:{moreVerificationOptions:{links:{learnHow:l.a.urlBag.verificationCodeHelp,recovery:"#",disclaimer:l.a.urlBag.accountRecoveryHelp},title:p.a.getString("verifyDeviceShowHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}},noIforgotOptions:{title:p.a.getString("noIforgotHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}}},dialogClick:function(){this.attr("showHelpDialog",!1),this.attr("showNoIforgotHelpDialog",!1)},accRecoveryClick:function(e){var t,o=this;return(t=regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o,t.next=3,y(e,r,T);case 3:r.attr("showNoIforgotHelpDialog",!1),r.attr("dialog.moreVerificationOptions.links.recovery","#");case 5:case"end":return t.stop()}}),t)})),function(){var e=this,o=arguments;return new Promise((function(r,n){var i=t.apply(e,o);function a(e){C(i,r,n,a,s,"next",e)}function s(e){C(i,r,n,a,s,"throw",e)}a(void 0)}))})()},suppressIforgotDialog:function(){this.attr("showAlternateOptions",!1),this.attr("showNoIforgotHelpDialog",!0)},recoveryNotAvailableClick:function(){this.attr("showHelpDialog",!0)}},events:{inserted:function(e,t){var o,r;this.viewModel.attr("phones",l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers),this.spinner=h.a,o=this.viewModel.phones,r=function(e){-1!==l.a.twoSV.supportedPushModes.indexOf(e.pushMode)&&("voice"===e.pushMode?e.attr("lastUsedPushModeText",p.a.getString("voiceCall")):"sms"===e.pushMode&&e.attr("lastUsedPushModeText",p.a.getString("textMsg")))},1===o.length?r(o[0]):n.a.each(o,(function(e,t){r(o[t])})),e.find("[tabindex=-1]")&&a()(e.find("[tabindex=-1]")[0]).focus()},".si-phone-row mouseup":function(e,t){if(1===t.which){this.viewModel.attr("selectedPhone",P(e.attr("phone-id"),this.viewModel.phones)),this.viewModel.selectedPhone.attr("selected",!0)}},".si-phone-row click":function(e,t){var o=this;setTimeout((function(){o.viewModel.attr("hideChev",!0),o.viewModel.selectedPhone.attr("selected",!1),o.spinner.start(a()(".arrow[data-id="+o.viewModel.selectedPhone.id+"]")),O(o.viewModel,!0),u.sendNewCode(o.viewModel.selectedPhone.id,o.viewModel.selectedPhone.pushMode).done((function(e,t,r){o.element.trigger("phoneSelected",[e])})).fail((function(e){423===e.status&&(o.viewModel.attr("lastCodeSentTo",o.viewModel.phones[0]),o.viewModel.attr("lastCodeSentTo.tooManyCodesSentLockObject",e.responseJSON)),T(e,o.viewModel)})).always((function(e,t,r){O(o.viewModel,!1),o.viewModel.attr("hideChev",!1),o.spinner.stop()}))}),200)},".error click":function(e,t){this.viewModel.attr("errorMessage","")},'[role="button"] focus':function(e,t){this.viewModel.attr("selectedPhone",P(e.attr("phone-id"),this.viewModel.phones))},"{viewModel} errorMessage":function(){if(this.viewModel.errorMessage){var e=this;setTimeout((function(){a()(".error",e.element).focus()}),1e3)}}}}),o(140),o(123),o(156),o(126)),x=o(41),N=o(162),D=o(575),A=o.n(D),V=o(17),j=o(90),H=(o(303),function(e,t){var o=a()(t),r=o.viewModel(),n=Object(f.a)(e.responseJSON,p.a.getString("fallback")),i=n.message;switch(e.status){case 400:Object(j.a)(n.code)?a()("hsa2").trigger("authFailed",n):r.attr("errorMessage",i);break;case 409:o.trigger("next_409",[e]);break;case 423:n.status.isTooManyCodesSent?(r.attr("errorMessage",p.a.getString("tooManyCodesSent")),r.attr("tooManyCodesSent")&&r.attr("tooManyCodesSent",!0)):n.status.isTooManyCodesValidated||n.status.isSecurityCodeLocked?r.attr("errorMessage",p.a.getString("securityCodeLocked")):r.attr("errorMessage",n.message);break;case 412:if(!e.getResponseHeader("location")){r.attr("errorMessage",locMessage("web.error.unknown.description"));break}o.trigger("repairAppleID",[e]),r.attr("isRepair",!0);break;default:r.attr("errorMessage",i)}});function F(e,t,o,r,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function I(e){return function(){var t=this,o=arguments;return new Promise((function(r,n){var i=e.apply(t,o);function a(e){F(i,r,n,a,s,"next",e)}function s(e){F(i,r,n,a,s,"throw",e)}a(void 0)}))}}var L=425,R=412,U=function(e){e.element.find(".char-field").val(""),e.viewModel.attr("verifyCode",""),e.element.find(".char-field").first().focus()},B=(n.a.Component.extend({tag:"verify-phone",template:n.a.view(A.a),viewModel:{define:{supportPin:{type:"object",value:function(){return{}}},authType:{type:"string",get:function(){return Object(s.a)(l.a,"authType")}},btnList:{type:"object",value:function(){var e=this;return{supportPin:{isDisabled:!1,btnText:p.a.getString("supportPinBtnText"),clickHandler:function(){e.attr("dialogType","generatePinDialog")}}}}},appleIdLinkTarget:{type:"string",value:function(){return l.a.appleIdLinkTarget}},recoveryNotAvailableLink:{type:"boolean",get:function(){return!(!this.attr("twoFactorVerificationSupportUrl")||this.attr("recoveryAvailable"))}},showMoreInformationDialog:{type:"boolean",value:!1}},dialogType:"verification",generatePinClickHandler:function(){var e=this;return I(regeneratorRuntime.mark((function t(){var o,r,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e,r="",n="",t.prev=1,o.attr("showSpinner","true"),t.next=5,N.a.getPin();case 5:i=t.sent,o.supportPin.attr("PIN",i.data.pin),r=i.data.date,n=p.a.getString("web.date.time.format.LT"),o.supportPin.attr("validUntil",k.a.formatDateTime({dateTimeISOString:r,momentFormatType:n,isUTCFormat:!0})),o.attr("showSpinner","false"),o.attr("dialogType","supportPinSuccess"),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(1),o.attr("showSpinner","false"),o.attr("dialogType","couldNotGenerateSupportPin");case 20:case"end":return t.stop()}}),t,null,[[1,15]])})))()},dialogClick:function(e,t){this.attr("showHelpDialog",!1),this.attr("showNoIforgotHelpDialog",!1),e===x.a.getHashCode(p.a.getString("btnTextGeneratePin").trim().toLowerCase())||e===x.a.getHashCode(p.a.getString("btnTextGenerateNewPin").trim().toLowerCase())?this.generatePinClickHandler():e===x.a.getHashCode(p.a.getString("btnTextDone").trim().toLowerCase())||e===x.a.getHashCode(p.a.getString("okText").trim().toLowerCase())?a()("hsa2").trigger("authFailed"):e===x.a.getHashCode(p.a.getString("btnTextGoBack").trim().toLowerCase())&&this.attr("dialogType","verification")},dialogClosed:function(){this.attr("isRepair")||a()("sa").trigger("authFailed")},generatePinDialog:{title:p.a.getString("titleGeneratePin"),btnOpts:{btnTexts:[p.a.getString("btnTextGoBack"),p.a.getString("btnTextGeneratePin")],direction:"center"}},generateNewPinDialog:{title:p.a.getString("titleGeneratePin"),btnOpts:{btnTexts:[p.a.getString("btnTextGenerateNewPin"),p.a.getString("btnTextDone")],direction:"center"}},couldNotGenerateSupportPinDialog:{title:p.a.getString("titleCanNotGeneratePin"),btnOpts:{btnTexts:[p.a.getString("okText")],direction:"center"}},twoFactorVerificationSupportUrl:"",mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),recoveryAvailable:!0,codeSentToPhone:null,verifyCode:"",errorMessage:"",codeLength:null,usedPushMode:"",localisedDigit:p.a.getString("localisedDigit"),allow:{verifyCode:!1},showSpinnerFor:{verifyingCode:!1,sendingCode:!1,calling:!1},otherOptionsClicked:!1,showAlternateOptions:!1,showHelpDialog:!1,showNoIforgotHelpDialog:!1,isRepair:!1,dialog:{moreVerificationOptions:{links:{learnHow:l.a.urlBag.verificationCodeHelp.trim(),recovery:"#",disclaimer:l.a.urlBag.accountRecoveryHelp.trim()},title:p.a.getString("verifyDeviceShowHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}},noIforgotOptions:{title:p.a.getString("noIforgotHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}}},suppressIforgot:null,hasMoreThanOneTrustedPhoneNumbers:!1,viewportWidth:window.innerWidth<=L||window.innerHeight<=R?"small":"large",accRecoveryClick:function(e){var t=this;return I(regeneratorRuntime.mark((function o(){var r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=t,o.next=3,y(e,r,(function(e,t){return H(e,"verify-phone")}));case 3:r.attr("showHelpDialog",!1),r.attr("showNoIforgotHelpDialog",!1),r.attr("showAlternateOptions",!1),r.attr("dialog.moreVerificationOptions.links.recovery","#");case 7:case"end":return o.stop()}}),o)})))()},suppressIforgotDialog:function(){return this.attr("showAlternateOptions",!1),this.attr("showNoIforgotHelpDialog",!0),!1},recoveryNotAvailableClick:function(){return this.attr("showAlternateOptions",!1),this.attr("showHelpDialog",!0),!1},moreInformationClick:function(e){e.preventDefault(),this.attr("showMoreInformationDialog",!0)}},events:{inserted:function(e,t){this.spinner=h.a;var o=this.viewModel;if(o.lastCodeSentToPhone&&""!==o.lastCodeSentToPhone.errorMessage)o.attr("errorMessage",o.lastCodeSentToPhone.errorMessage),o.attr("codeSentToPhoneNumber","restricted"===o.attr("authType")?o.lastCodeSentToPhone.numberWithDialCode:o.lastCodeSentToPhone.obfuscatedNumber),o.attr("usedPushMode",o.lastCodeSentToPhone.pushMode),o.attr("codeLength",6),o.codeSentToPhone&&o.codeSentToPhone.securityCode&&o.codeSentToPhone.securityCode.tooManyCodesSent&&o.attr("tooManyCodesSent",o.codeSentToPhone.securityCode.tooManyCodesSent);else if(o.codeSentToPhone&&o.codeSentToPhone.securityCode){var r=o.codeSentToPhone.serviceErrors||o.codeSentToPhone.service_errors||o.codeSentToPhone.validationErrors;void 0!==r&&(r.length>0?(o.attr("errorMessage",r[0].message),o.codeSentToPhone.securityCode.tooManyCodesSent&&o.attr("tooManyCodesSent",!0)):o.attr("errorMessage",p.a.getString("fallback"))),o.attr("codeSentToPhoneNumber","restricted"===o.attr("authType")?o.codeSentToPhone.phoneNumber.numberWithDialCode:o.codeSentToPhone.phoneNumber.obfuscatedNumber),o.attr("usedPushMode",o.codeSentToPhone.phoneNumber.pushMode),o.codeSentToPhone.securityCode.length&&""!==o.codeSentToPhone.securityCode.length?o.attr("codeLength",o.codeSentToPhone.securityCode.length):o.attr("codeLength",6)}o.attr("hasMoreThanOneTrustedPhoneNumbers",l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length>1)}," keyup":function(e,t){27===t.which&&(this.viewModel.showAlternateOptions||this.viewModel.attr("showMoreInformationDialog"))&&(this.viewModel.attr("showAlternateOptions",!1),this.viewModel.attr("showMoreInformationDialog",!1),this.viewModel.otherOptionsClicked&&this.viewModel.attr("otherOptionsClicked",!1))},"security-code completed":function(e,t,o){var r;Object(V.f)(["authSecondFactor"]),this.viewModel.attr("verifyCode",o),(r=this).viewModel.attr("errorMessage",""),r.viewModel.attr("showSpinnerFor.verifyingCode",!0),Object(V.f)(["authSecondFactor","verifyPhoneCalled"]),r.viewModel.tooManyCodesSent&&r.viewModel.lastCodeSentToPhone?u.verifyPhone(r.viewModel.lastCodeSentToPhone.id,r.viewModel.verifyCode,r.viewModel.lastCodeSentToPhone.tooManyCodesSentLockObject.mode).done((function(e,t,o){Object(V.e)(["authSecondFactor","verifyPhoneCalled"]),r.element.trigger("authCompleted",[o])})).fail((function(e,t,o){U(r),r.viewModel.attr("showSpinnerFor.verifyingCode",!1),H(e,"verify-phone")})):u.verifyPhone(r.viewModel.codeSentToPhone.phoneNumber.id,r.viewModel.verifyCode,r.viewModel.codeSentToPhone.phoneNumber.pushMode).done((function(e,t,o){Object(V.e)(["endAuthSecondFactor","verifyPhoneCalled"]),r.element.trigger("authCompleted",[o])})).fail((function(e,t,o){U(r),r.viewModel.attr("showSpinnerFor.verifyingCode",!1),H(e,"verify-phone")}))},".char-field keypress":function(e,t){this.viewModel.attr("errorMessage","")},"#didnt-get-code click":function(e,t){return this.viewModel.attr("showAlternateOptions",!this.viewModel.showAlternateOptions),this.viewModel.attr("showMoreInformationDialog",!1),!1},"#use-diff-ph click":function(e,t){return this.element.trigger("usePhone"),!1},"#other-opts click":function(e,t){return this.viewModel.attr("otherOptionsClicked",!this.viewModel.otherOptionsClicked),this.viewModel.attr("showAlternateOptions",!this.viewModel.showAlternateOptions),!1},".error click":function(e,t){this.viewModel.attr("errorMessage","")},"#try-again click":function(e,t){var o=this;return o.viewModel.attr("errorMessage",""),setTimeout((function(){o.viewModel.attr("showSpinnerFor.calling",!0),u.sendNewCode(o.viewModel.codeSentToPhone.phoneNumber.id,o.viewModel.codeSentToPhone.phoneNumber.pushMode).done((function(e,t,o){})).fail((function(e){H(e,"verify-phone")})).always((function(e,t,r){o.viewModel.attr("showSpinnerFor.calling",!1),o.viewModel.attr("showAlternateOptions",!1),o.viewModel.attr("showMoreInformationDialog",!1)}))}),300),!1},"#call-me click":function(e,t){var o=this;return o.viewModel.attr("errorMessage",""),o.viewModel.attr("showAlternateOptions",!1),o.element.find(".char-field").first().focus(),setTimeout((function(){o.viewModel.attr("showSpinnerFor.sendingCode",!0),u.sendNewCode(o.viewModel.codeSentToPhone.phoneNumber.id,"voice").done((function(e,t,r){o.viewModel.attr("codeSentToPhone",e),o.viewModel.attr("usedPushMode","voice")})).fail((function(e){H(e,"verify-phone")})).always((function(e,t,r){o.viewModel.attr("showSpinnerFor.sendingCode",!1)}))}),300),!1},"#sms-me click":function(e,t){var o=this;return o.viewModel.attr("errorMessage",""),o.viewModel.attr("showAlternateOptions",!1),o.element.find(".char-field").first().focus(),setTimeout((function(){o.viewModel.attr("showSpinnerFor.sendingCode",!0),u.sendNewCode(o.viewModel.codeSentToPhone.phoneNumber.id,"sms").done((function(e,t,r){o.viewModel.attr("codeSentToPhone",e),o.viewModel.attr("usedPushMode","sms")})).fail((function(e){H(e,"verify-phone")})).always((function(e,t,r){o.viewModel.attr("showSpinnerFor.sendingCode",!1)}))}),300),!1},"idms-modal modalClose":function(e,t){this.viewModel.attr("showHelpDialog",!1),this.viewModel.attr("showNoIforgotHelpDialog",!1),this.viewModel.attr("showMoreInformationDialog",!1)},"{scope} showSpinnerFor.verifyingCode":function(e,t,o){o?this.spinner.start(a()("#verifying-code"),"small"):this.spinner.stop()},"{scope} showAlternateOptions":function(e,t,o,r){o||this.viewModel.attr("otherOptionsClicked",!1)},"{scope} showSpinnerFor.sendingCode":function(e,t,o){o?this.spinner.start(a()("#sending-code"),"small"):this.spinner.stop()}}}),function(){});(B.prototype=new c.a).constructor=B,B.prototype.pushAuthCode=function(e){return this.put({url:l.a.urlContext+e})};var _=new B,J=o(576),E=o.n(J);function G(e,t,o,r,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}var q=425,W=412,K=function(e,t){var o=a()("verify-device"),r=Object(f.a)(e.responseJSON),n=Object(f.a)(e.responseJSON,p.a.getString("fallback")).message;switch(e.status){case 400:Object(j.a)(r.code)?a()("hsa2").trigger("authFailed",r):t.attr("errorMessage",n);break;case 409:o.trigger("next_409",[e]);break;case 423:r.status.isTooManyCodesSent?t.attr("errorMessage",p.a.getString("tooManyCodesSent")):r.status.isTooManyCodesValidated||r.status.isSecurityCodeLocked?t.attr("errorMessage",p.a.getString("securityCodeLocked")):t.attr("errorMessage",r.message);break;case 412:if(!e.getResponseHeader("location")){t.attr("errorMessage",Object(p.b)("web.error.unknown.description"));break}o.trigger("repairAppleID",[e]),t.attr("isRepair",!0);break;default:t.attr("errorMessage",n)}},X=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_.pushAuthCode("/auth/verify/trusteddevice/securitycode").fail((function(t,o,r){e.viewModel.attr("allow.resendCode",!(423===t.status)),K(t,e.viewModel)})).always((function(){e.viewModel.attr("showAlternateOptions",t),e.element.find(".char-field").first().focus()}))},z=(n.a.Component.extend({tag:"verify-device",template:n.a.view(E.a),viewModel:{define:{appleIdLinkTarget:{type:"string",value:function(){return l.a.appleIdLinkTarget}},recoveryNotAvailableLink:{type:"boolean",get:function(){return!(!this.attr("twoFactorVerificationSupportUrl")||this.attr("recoveryAvailable"))}}},mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),twoFactorVerificationSupportUrl:"",recoveryAvailable:!0,verifyCode:"",errorMessage:"",codeLength:null,allow:{verifyCode:!1,resendCode:!0,sendText:!0},suppressIforgot:null,showSpinnerFor:{verifyingCode:!1,gettingRecoveryPath:!1},showAlternateOptions:!1,localisedDigit:p.a.getString("localisedDigit"),lastUsedPushMode:"",hasOnlyOneTrustedPhoneNumber:!1,showHelpDialog:!1,isRepair:!1,dialogClick:function(){this.attr("showHelpDialog",!1),this.attr("showNoIforgotHelpDialog",!1)},dialog:{moreVerificationOptions:{links:{learnHow:l.a.urlBag.verificationCodeHelp,recovery:"#",disclaimer:l.a.urlBag.accountRecoveryHelp},title:p.a.getString("verifyDeviceShowHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}},noIforgotOptions:{title:p.a.getString("noIforgotHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}}},viewportWidth:window.innerWidth<=q||window.innerHeight<=W?"small":"large",accRecoveryClick:function(e){var t,o=this;return(t=regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=o).attr("showSpinnerFor.gettingRecoveryPath",!0),t.next=4,y(e,r,K);case 4:r.attr("showHelpDialog",!1),r.attr("showSpinnerFor.gettingRecoveryPath",!1),r.attr("showNoIforgotHelpDialog",!1),r.attr("showAlternateOptions",!1),a()("security-code").find(".char-field").first().focus(),r.attr("dialog.moreVerificationOptions.links.recovery","#");case 10:case"end":return t.stop()}}),t)})),function(){var e=this,o=arguments;return new Promise((function(r,n){var i=t.apply(e,o);function a(e){G(i,r,n,a,s,"next",e)}function s(e){G(i,r,n,a,s,"throw",e)}a(void 0)}))})()},suppressIforgotDialog:function(){this.attr("showAlternateOptions",!1),this.attr("showNoIforgotHelpDialog",!0)},recoveryNotAvailableClick:function(){this.attr("showAlternateOptions",!1),this.attr("showHelpDialog",!0)}},events:{inserted:function(e,t){l.a.isResume2FA&&l.a.hasTrustedDevices&&X(this,!1),l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers&&this.viewModel.attr("hasOnlyOneTrustedPhoneNumber",1===l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length),this.spinner=h.a,this.viewModel.hasOnlyOneTrustedPhoneNumber&&this.viewModel.attr("lastUsedPushMode",l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers[0].pushMode);var o=this.viewModel;this.element.find(".char-field").first().focus(),o.attr("codeLength",6)},keyup:function(e,t){27===t.which&&this.viewModel.showAlternateOptions&&this.viewModel.attr("showAlternateOptions",!1)},"security-code completed":function(e,t,o){var r;Object(V.f)(["authSecondFactor"]),this.viewModel.attr("verifyCode",o),(r=this).viewModel.attr("errorMessage",""),r.viewModel.attr("showSpinnerFor.verifyingCode",!0),Object(V.f)(["authSecondFactor","verifyDeviceCalled"]),u.verifyDevice(r.viewModel.verifyCode).done((function(e,t,o){Object(V.e)(["authSecondFactor","verifyDeviceCalled"]),r.element.trigger("authCompleted",[o])})).fail((function(e,t,o){!function(e){e.element.find(".char-field").val(""),e.viewModel.attr("verifyCode",""),e.element.find(".char-field").first().focus()}(r),K(e,r.viewModel)})).always((function(){r.viewModel.attr("showSpinnerFor.verifyingCode",!1)}))},".char-field keyup":function(e,t){this.viewModel.attr("errorMessage","")},"#no-trstd-device-pop click":function(e,t){return this.viewModel.attr("showAlternateOptions",!this.viewModel.showAlternateOptions),this.viewModel.attr("showAlternateOptions")||this.element.find(".char-field").first().focus(),!1},"#use-phone click":function(e,t){var o=l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers,r=this;return 1===o.length?u.sendNewCode(o[0].id,o[0].pushMode).done((function(e){r.element.trigger("codeSent",[e])})).fail((function(e){r.viewModel.attr("allow.sendText",!(423===e.status)),r.viewModel.attr("showAlternateOptions",!1),K(e,r.viewModel)})).always((function(e){})):r.element.trigger("usePhone"),!1},"#try-again click":function(e,t){return X(this,!1),!1},".error click":function(e,t){this.viewModel.attr("errorMessage","")},"idms-modal modalClose":function(e,t){this.viewModel.attr("showHelpDialog",!1),this.element.find(".char-field").first().focus(),this.viewModel.attr("showNoIforgotHelpDialog",!1)},"{viewModel} showSpinnerFor.verifyingCode":function(e,t,o){o?this.spinner.start(a()("#verifying-code"),"small"):this.spinner.stop()},"{viewModel} showSpinnerFor.gettingRecoveryPath":function(e,t,o){o?this.spinner.start(a()("#getting-recovery-path")):this.spinner.stop()}}}),o(230),o(48)),Q=o.n(z),Y=o(577),Z=o.n(Y),$=o(55),ee=o(115);function te(e,t,o,r,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function oe(e){return function(){var t=this,o=arguments;return new Promise((function(r,n){var i=e.apply(t,o);function a(e){te(i,r,n,a,s,"next",e)}function s(e){te(i,r,n,a,s,"throw",e)}a(void 0)}))}}var re,ne=function(e){return"AbortError"===e.name?"":"NotAllowedError"===e.name?"safari".indexOf(Object(s.a)(Q.a,"browser.name",""))>-1&&"The origin of the document is not the same as its ancestors."===e.message?"updateBrowser":"firefox".indexOf(Object(s.a)(Q.a,"browser.name",""))>-1&&(e.message.includes("CredentialContainer request is not allowed.")||e.message.includes("The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission.")&&parseInt(Object(s.a)(Q.a,"browser.major",0))<106)?"browserNotSupport":"":"safari".indexOf(Object(s.a)(Q.a,"browser.name",""))>-1?"updateBrowser":"browserNotSupport"};function ie(){return(ie=oe(regeneratorRuntime.mark((function e(t){var o,r,n,i,a,c,l,d,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>1&&void 0!==u[1]&&u[1],t.viewModel.attr("errorMessage",""),t.viewModel.attr("domErrorMessage",""),t.viewModel.attr("showSpinner",!0),t.viewModel.attr("forceAuth",o),r=t.viewModel.attr("fsaVerification.fsaChallenge").serialize(),n=r.challenge,i=r.keyHandles,a=r.rpId,e.prev=6,e.next=9,Object($.c)({challenge:n,rpId:a,userVerification:"preferred",keyHandles:i,useBase64Url:!1,timeout:6e4});case 9:c=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(6),t.viewModel.attr("domErrorMessage",ne(e.t0)),e.abrupt("return");case 16:return e.prev=16,l=Object($.b)(c,a,void 0,!1),e.next=20,ee.a.verifyClientAssertion(l);case 20:d=e.sent,t.element.trigger("authCompleted",Object(s.a)(d,"jqXHR")),e.next=27;break;case 24:e.prev=24,e.t1=e.catch(16),H(Object(s.a)(e.t1,"jqXHR",{}),"verify-key");case 27:t.viewModel.attr("showSpinner",!1);case 28:case"end":return e.stop()}}),e,null,[[6,12],[16,24]])})))).apply(this,arguments)}n.a.Component.extend({tag:"verify-key",template:n.a.view(Z.a),viewModel:{define:{isWebAuthnSupported:{value:function(){return Object($.d)()}},appDomain:{value:function(){var e=Object(s.a)(l.a,"destinationDomain","");return e?new URL(e).hostname:""}}},mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),errorMessage:"",domErrorMessage:"",showSpinner:!1,forceAuth:!1,fsaVerification:{},doKeyAssertion:function(){!function(e){ie.apply(this,arguments)}(re)}},events:{inserted:function(e){re=this,e.find("[tabindex=-1]")&&a()(e.find("[tabindex=-1]")[0]).focus(),this.spinner=h.a}}}),o(305);var ae=o(578),se=o.n(ae),ce=function(e,t,o){e.attr("lastCodeSentToPhone",o),t.responseJSON?e.attr("codeSentToPhone",t.responseJSON):e.attr("codeSentToPhone",t),e.attr("section","verifyPhone")},le=function(e,t){l.a.is2SVTrustEligible&&!e.viewModel.attr("skipTrustBrowserStep")?(t&&e.viewModel.attr("xhr",t),e.viewModel.attr("section","trustMyBrowser")):e.element.trigger("authSuccess",t)},de=n.a.Component.extend({tag:"hsa2",template:n.a.view(se.a),viewModel:{define:{twoFactorVerificationSupportUrl:{type:"string",value:function(){return Object(s.a)(l.a,"twoSV.phoneNumberVerification.twoFactorVerificationSupportUrl","")}},recoveryAvailable:{type:"boolean",get:function(){var e=!0;return Object(s.a)(l.a,"twoSV.phoneNumberVerification.hasRecoveryKey",!1)&&!Object(s.a)(l.a,"twoSV.phoneNumberVerification.supportsRecoveryKey",!1)&&(e=!1),e}},suppressCompletionSpinner:{type:"boolean",get:function(){return"FALSE"===Object(s.a)(l.a,"envConfigFromConsumer.waitAnimationOnAuthComplete",!1).toString().trim().toUpperCase()}},fsaVerification:{type:"object",get:function(){return Object(s.a)(l.a,"twoSV.fsaVerification",{})}}},section:"",selectedPhone:null,xhr:null,suppressIforgot:!1,fsaVerification:null},init:function(e,t){Object(V.f)(["loadHSA2Component"])},events:{inserted:function(){Object(V.e)(["authFirstFactor"]),"managed"===l.a.authType&&this.viewModel.attr("suppressIforgot",!0),this.element.trigger("__inserted"),l.a.hasTrustedDevices?this.viewModel.attr("section","verifyDevice"):l.a.twoSV.phoneNumberVerification?l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers?0===l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length||(1===l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length?ce(this.viewModel,l.a.twoSV.phoneNumberVerification):l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length>1&&this.viewModel.attr("section","phones")):(l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers=[],l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.push(l.a.twoSV.phoneNumberVerification),ce(this.viewModel,l.a.twoSV.phoneNumberVerification)):l.a.twoSV.fsaVerification&&l.a.twoSV.authFactors&&"fsa2_hsa2"===l.a.twoSV.authFactors[0]&&this.viewModel.attr("section","verifyKey")},"{viewModel} section":function(){this.element.trigger("section",[this.viewModel.attr("section")])},"phones phoneSelected":function(e,t,o,r){ce(this.viewModel,o,r)},"verify-phone authCompleted":function(e,t,o){le(this,o)},"verify-key authCompleted":function(e,t,o){le(this,o)},"verify-phone next_409":function(e,t,o){this.element.trigger("next_409",[o])},"verify-phone noTrustedPhones":function(e,t){this.viewModel.attr("section","phones")},"verify-phone usePhone":function(e,t){this.viewModel.attr("section","phones")},"verify-device codeSent":function(e,t,o){ce(this.viewModel,o)},"verify-device authCompleted":function(e,t,o){le(this,o)},"verify-device usePhone":function(e,t){this.viewModel.attr("section","phones")},"verify-device next_409":function(e,t,o){this.element.trigger("next_409",[o])},"trust-browser complete":function(e,t,o){o?this.element.trigger("authSuccess",o):this.element.trigger("authSuccess",this.viewModel.xhr)}}});t.default=de},48:function(e,t){e.exports=Detectizr},574:function(e,t){e.exports="jstache_527586407"},575:function(e,t){e.exports="jstache_1491168329"},576:function(e,t){e.exports="jstache_1947113137"},577:function(e,t){e.exports="jstache_233718467"},578:function(e,t){e.exports="jstache_19243547"}},[[1013,1,0]]]);
